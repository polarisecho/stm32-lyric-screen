#include "stm32f10x.h"                  // Device header
#include "delay.h"
#include "lcd12864.h"
#include "led.h"
#include "draw.h"
#include "animation.h"
#include "uart.h"

extern _Bool endflag;

uint8_t uartbuf[2048] = {
    0x00, 0x00,0x00, 0xC0,0x1F, 0xC0,0x03, 0xC0,0x06, 0x60,0x0C, 0x38,0x18, 0x3E,0x6C, 0xFE,0x83, 0x80,0x01, 0x90,0x1F, 0xF8,0x01, 0x80,0x01, 0x8C,0x3F, 0xFC,0x00, 0x00,0x00, 0x00,
    0x00, 0x00,0x01, 0x00,0x01, 0x80,0x21, 0x88,0x3F, 0xFC,0x30, 0x0C,0x34, 0x4C,0x37, 0xEC,0x36, 0x4C,0x36, 0x4C,0x37, 0xCC,0x34, 0x4C,0x34, 0x0C,0x30, 0x0C,0x30, 0x3C,0x20, 0x10,
    0x00, 0x00,0x01, 0xC0,0x20, 0x88,0x1F, 0xFC,0x70, 0x4C,0x67, 0xD0,0x06, 0x40,0x04, 0x20,0x08, 0x30,0x18, 0x7E,0x6F, 0xC0,0x01, 0x00,0x01, 0x00,0x7F, 0xFC,0x00, 0x00,0x00, 0x00,
    0x00, 0x00,0x00, 0x00,0x0C, 0x84,0x09, 0xFC,0x7F, 0x84,0x1C, 0xFC,0x1A, 0x84,0x38, 0xFC,0x48, 0x84,0x08, 0xFC,0x06, 0x80,0x24, 0xC4,0x24, 0x46,0x60, 0x12,0x07, 0xF2,0x01, 0xC0
};

extern uint16_t disbuf[8][64];
extern volatile uint8_t charcount,textsize;



int main()
{
	Delay_ms(250);
	LCD_Init();
	Uart1_Init();
	Set_Graphic_Mode();
//	Clear_GDRAM();
//	Write_disbuf(0x0709,0xaaaa,1);
//	Write_disbuf(0x0709,0xcccc,1);
//	Delay_ms(200);
//	Write_disbuf(0x070b,0xCCCC,1);
//	Write_disbuf(0x0737,0xaaaa,1);
//	Delay_ms(200);
//	Write_disbuf(0x0739,0xCCCC,1);
////	Delay_ms(2000);
//	uint8_t cyr;
//	for(cyr=1;cyr<32;cyr+=5)
//	{
//		DrawCircle(64,32,cyr,1);
//		//Refresh_disbuf_List();
//	}
//	DrawFastHLine(0,17,18,1);
//	DrawFastVLine(0,17,18,1);
//	Refresh_disbuf_List();

//	DrawRect(31,0,96,64,1);
//	Refresh_disbuf_List();
//	Draw_RadialLines(8,1);
//	Refresh_disbuf_List();
//	DrawRect(0,36,16,20,1);
//	Refresh_disbuf_List();
	Floattext_16(4,1);
	while(1)
	{
		endflag=0;
		if(textsize==0)
		{
			Set_Graphic_Mode();
		}
		else if(textsize==3)
		{
			Set_Graphic_Mode();
			random64(charcount,1);
		}
		else if(textsize==2)
		{
			Set_Graphic_Mode();
			random32(charcount,1);
		}
		else if(textsize==1)
		{
			Set_Graphic_Mode();
			random16(charcount,1);
		}
		//Floattext_16(charcount,1);
		/*
	uint8_t tx1=10,ty1=5,tx2=50,ty2=60,tx3=115,ty3=30;
	uint8_t tx1o=0,ty1o=0,tx2o=0,ty2o=1,tx3o=1,ty3o=0;
	uint8_t tx1o2=0,ty1o2=0,tx2o2=0,ty2o2=1,tx3o2=1,ty3o2=0;
	while(tx1<124)
	{
		DrawTriangle(tx1,ty1,tx2,ty2,tx3,ty3,1);
		Refresh_disbuf_List();
		Delay_ms(10);
		DrawTriangle(tx1o2,ty1o2,tx2o2,ty2o2,tx3o2,ty3o2,0);
		Refresh_disbuf_List();
		tx1+=2;ty1++;ty2--;tx3-=2;
		tx1o2=tx1o;ty1o2=ty1o;tx2o2=tx2o;ty2o2=ty2o;tx3o2=tx3o;ty3o2=ty3o;
		tx1o=tx1;ty1o=ty1;tx2o=tx2;ty2o=ty2;tx3o=tx3;ty3o=ty3;
	}
		*/
	}
}
